{"ast":null,"code":"\"use strict\";\n\n// Copyright 2021 Google LLC\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.googleProtobufTimestampFromProto3JSON = exports.googleProtobufTimestampToProto3JSON = void 0;\nfunction googleProtobufTimestampToProto3JSON(obj) {\n  var _a;\n  // seconds is an instance of Long so it won't be undefined\n  const durationSeconds = obj.seconds;\n  const date = new Date(durationSeconds * 1000).toISOString();\n  // Pad leading zeros if nano string length is less than 9.\n  let nanos = (_a = obj.nanos) === null || _a === void 0 ? void 0 : _a.toString().padStart(9, '0');\n  // Trim the unsignificant zeros and keep 3, 6, or 9 decimal digits.\n  while (nanos && nanos.length > 3 && nanos.endsWith('000')) {\n    nanos = nanos.slice(0, -3);\n  }\n  return date.replace(/(?:\\.\\d{0,9})/, '.' + nanos);\n}\nexports.googleProtobufTimestampToProto3JSON = googleProtobufTimestampToProto3JSON;\nfunction googleProtobufTimestampFromProto3JSON(json) {\n  const match = json.match(/^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(?:\\.\\d+)?/);\n  if (!match) {\n    throw new Error(`googleProtobufDurationFromProto3JSON: incorrect value ${json} passed as google.protobuf.Duration`);\n  }\n  const date = new Date(json);\n  const millisecondsSinceEpoch = date.getTime();\n  const seconds = Math.floor(millisecondsSinceEpoch / 1000);\n  // The fractional seconds in the JSON timestamps can go up to 9 digits (i.e. up to 1 nanosecond resolution).\n  // However, Javascript Date object represent any date and time to millisecond precision.\n  // To keep the precision, we extract the fractional seconds and append 0 until the length is equal to 9.\n  let nanos = 0;\n  const secondsFromDate = json.split('.')[1];\n  if (secondsFromDate) {\n    nanos = parseInt(secondsFromDate.slice(0, -1).padEnd(9, '0'));\n  }\n  const result = {};\n  if (seconds !== 0) {\n    result.seconds = seconds;\n  }\n  if (nanos !== 0) {\n    result.nanos = nanos;\n  }\n  return result;\n}\nexports.googleProtobufTimestampFromProto3JSON = googleProtobufTimestampFromProto3JSON;","map":{"version":3,"mappings":";;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AAUA,SAAgBA,mCAAmC,CACjDC,GAAiC;;EAEjC;EACA,MAAMC,eAAe,GAAGD,GAAG,CAACE,OAAO;EACnC,MAAMC,IAAI,GAAG,IAAIC,IAAI,CAACH,eAAe,GAAG,IAAI,CAAC,CAACI,WAAW,EAAE;EAC3D;EACA,IAAIC,KAAK,GAAG,SAAG,CAACA,KAAK,0CAAEC,QAAQ,GAAGC,QAAQ,CAAC,CAAC,EAAE,GAAG,CAAC;EAClD;EACA,OAAOF,KAAK,IAAIA,KAAK,CAACG,MAAM,GAAG,CAAC,IAAIH,KAAK,CAACI,QAAQ,CAAC,KAAK,CAAC,EAAE;IACzDJ,KAAK,GAAGA,KAAK,CAACK,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;;EAE5B,OAAOR,IAAI,CAACS,OAAO,CAAC,eAAe,EAAE,GAAG,GAAGN,KAAK,CAAC;AACnD;AAbAO;AAeA,SAAgBC,qCAAqC,CAACC,IAAY;EAChE,MAAMC,KAAK,GAAGD,IAAI,CAACC,KAAK,CAAC,gDAAgD,CAAC;EAC1E,IAAI,CAACA,KAAK,EAAE;IACV,MAAM,IAAIC,KAAK,CACb,yDAAyDF,IAAI,qCAAqC,CACnG;;EAEH,MAAMZ,IAAI,GAAG,IAAIC,IAAI,CAACW,IAAI,CAAC;EAC3B,MAAMG,sBAAsB,GAAGf,IAAI,CAACgB,OAAO,EAAE;EAC7C,MAAMjB,OAAO,GAAGkB,IAAI,CAACC,KAAK,CAACH,sBAAsB,GAAG,IAAI,CAAC;EACzD;EACA;EACA;EACA,IAAIZ,KAAK,GAAG,CAAC;EACb,MAAMgB,eAAe,GAAGP,IAAI,CAACQ,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;EAC1C,IAAID,eAAe,EAAE;IACnBhB,KAAK,GAAGkB,QAAQ,CAACF,eAAe,CAACX,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAACc,MAAM,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC;;EAE/D,MAAMC,MAAM,GAAoB,EAAE;EAClC,IAAIxB,OAAO,KAAK,CAAC,EAAE;IACjBwB,MAAM,CAACxB,OAAO,GAAGA,OAAO;;EAE1B,IAAII,KAAK,KAAK,CAAC,EAAE;IACfoB,MAAM,CAACpB,KAAK,GAAGA,KAAK;;EAEtB,OAAOoB,MAAM;AACf;AA1BAb","names":["googleProtobufTimestampToProto3JSON","obj","durationSeconds","seconds","date","Date","toISOString","nanos","toString","padStart","length","endsWith","slice","replace","exports","googleProtobufTimestampFromProto3JSON","json","match","Error","millisecondsSinceEpoch","getTime","Math","floor","secondsFromDate","split","parseInt","padEnd","result"],"sources":["../../typescript/src/timestamp.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script","externalDependencies":[]}