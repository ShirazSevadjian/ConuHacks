"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react"),t=require("react-dom"),n=require("framer-motion"),o=require("@react-aria/utils"),r=require("react-merge-refs");function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}function a(e,t){if(null==e)return{};var n,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)t.indexOf(n=i[o])>=0||(r[n]=e[n]);return r}var s="calc(100% - env(safe-area-inset-top) - 34px)",c="undefined"==typeof window,l={stiffness:300,damping:30,mass:.2};function u(e,t){return e.reduce((function(e,n){return Math.abs(n-t)<Math.abs(e-t)?n:e}))}function d(e){var t=document.querySelector("body"),n=document.getElementById(e),o=document.getElementById("react-modal-sheet-highlight");n&&o&&(n.style.removeProperty("border-top-right-radius"),n.style.removeProperty("border-top-left-radius"),n.style.removeProperty("transform"),o.style.opacity="0",n.addEventListener("transitionend",(function e(){var r;n.style.removeProperty("overflow"),n.style.removeProperty("will-change"),n.style.removeProperty("transition"),t.style.removeProperty("background-color"),n.removeEventListener("transitionend",e),null==(r=o.parentNode)||r.removeChild(o)})))}function f(e){var t=e.snapTo,n=e.sheetHeight;return t<0&&console.warn("Snap point is out of bounds. Sheet height is "+n+" but snap point is "+(n+Math.abs(t))+"."),Math.max(Math.round(t),0)}var p=c?e.useEffect:e.useLayoutEffect;function m(t){var n=e.useRef();return e.useEffect((function(){n.current=t})),n.current}function h(t){var n=e.useRef();return p((function(){n.current=t})),e.useCallback((function(){for(var e=n.current,t=arguments.length,o=new Array(t),r=0;r<t;r++)o[r]=arguments[r];return null==e?void 0:e.apply(void 0,o)}),[])}var g,v=e.createContext(void 0),y=function(){var t=e.useContext(v);if(!t)throw Error("Sheet context error");return t},b="undefined"!=typeof window&&window.visualViewport,w=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]),E=0;function x(e,t,n){var o=e.style[t];return e.style[t]=n,function(){e.style[t]=o}}function C(e,t,n,o){return e.addEventListener(t,n,o),function(){e.removeEventListener(t,n,o)}}function O(e){for(var t=document.scrollingElement||document.documentElement;e&&e!==t;){var n=o.getScrollParent(e);if(n!==document.documentElement&&n!==document.body&&n!==e){var r=n.getBoundingClientRect().top,i=e.getBoundingClientRect().top;i>r+e.clientHeight&&(n.scrollTop+=i-r)}e=n.parentElement}}function R(e){return e instanceof HTMLInputElement&&!w.has(e.type)||e instanceof HTMLTextAreaElement||e instanceof HTMLElement&&e.isContentEditable}var S={wrapper:{position:"fixed",top:0,bottom:0,left:0,right:0,zIndex:9999999,overflow:"hidden",pointerEvents:"none"},backdrop:{zIndex:1,position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(51, 51, 51, 0.5)",touchAction:"none",border:"none"},container:{zIndex:2,position:"absolute",left:0,bottom:0,width:"100%",backgroundColor:"#fff",borderTopRightRadius:"8px",borderTopLeftRadius:"8px",boxShadow:"0px -2px 16px rgba(0, 0, 0, 0.3)",display:"flex",flexDirection:"column",pointerEvents:"auto"},headerWrapper:{width:"100%"},header:{height:"40px",width:"100%",position:"relative",display:"flex",alignItems:"center",justifyContent:"center"},indicator:{width:"18px",height:"4px",borderRadius:"99px",backgroundColor:"#ddd"},content:{flex:1,overflow:"auto",position:"relative"}},P=e.forwardRef((function(r,s){var y=r.onOpenStart,w=r.onOpenEnd,P=r.onClose,T=r.onCloseStart,M=r.onCloseEnd,k=r.onSnap,H=r.children,D=r.isOpen,L=r.snapPoints,N=r.rootId,q=r.mountPoint,A=r.style,I=r.detent,j=void 0===I?"full-height":I,B=r.initialSnap,z=void 0===B?0:B,W=r.springConfig,Y=void 0===W?l:W,F=r.disableDrag,V=void 0!==F&&F,X=r.prefersReducedMotion,_=void 0!==X&&X,G=a(r,["onOpenStart","onOpenEnd","onClose","onCloseStart","onCloseEnd","onSnap","children","isOpen","snapPoints","rootId","mountPoint","style","detent","initialSnap","springConfig","disableDrag","prefersReducedMotion"]),J=e.useRef(null),K=n.useMotionValue(0),Q=function(){var t=e.useState(0),n=t[0],o=t[1];return p((function(){var e=function(){return o(window.innerHeight)};return window.addEventListener("resize",e),e(),function(){return window.removeEventListener("resize",e)}}),[]),n}(),U=n.useReducedMotion(),Z=Boolean(_||U),$=Z?{type:"tween",duration:.01}:i({type:"spring"},Y),ee=n.useMotionValue(0),te=e.useRef({onOpenStart:y,onOpenEnd:w,onCloseStart:T,onCloseEnd:M});p((function(){te.current={onOpenStart:y,onOpenEnd:w,onCloseStart:T,onCloseEnd:M}})),L&&(L=L.map((function(e){return e>0&&e<=1?Math.round(e*Q):e<0?Q+e:e})),console.assert(function(e){for(var t=0;t<e.length;t++)if(e[t+1]>e[t])return!1;return!0}(L)||0===Q,"Snap points need to be in descending order got: ["+L+"]"));var ne=h((function(e,t){var n=t.delta,o=ee.getVelocity();o>0&&K.set(10),o<0&&K.set(-10),ee.set(Math.max(ee.get()+n.y,0))})),oe=h((function(e,t){if(t.velocity.y>500)P();else{var o=J.current.getBoundingClientRect().height,r=ee.get(),i=0;if(L){var a=L.map((function(e){return o-e})).filter((function(e){return e>=0}));"content-height"!==j||a.includes(0)||a.unshift(0),i=u(a,r)}else r/o>.6&&(i=o);if(i=f({snapTo:i,sheetHeight:o}),n.animate(ee,i,$),L&&k){var s=Math.abs(Math.round(L[0]-i)),c=L.indexOf(u(L,s));k(c)}i>=o&&P()}K.set(0)}));e.useEffect((function(){L&&k&&k(D?z:L.length-1)}),[D]),e.useImperativeHandle(s,(function(){return{y:ee,snapTo:function(e){var t=J.current;if(L&&void 0!==L[e]&&null!==t){var o=t.getBoundingClientRect().height,r=f({snapTo:o-L[e],sheetHeight:o});n.animate(ee,r,$),k&&k(e),r>=o&&P()}}}})),function(t,n){var o=m(t);e.useEffect((function(){n&&!o&&t?function(e){var t=document.querySelector("body"),n=document.querySelector("#"+e);if(n){var o=window.innerHeight,r=(o-24)/o;t.style.backgroundColor="#000",n.style.overflow="hidden",n.style.willChange="transform",n.style.transition="transform 200ms linear",n.style.transform="translateY(calc(env(safe-area-inset-top) + 12px)) scale("+r+")",n.style.borderTopRightRadius="10px",n.style.borderTopLeftRadius="10px";var i=document.createElement("div");i.setAttribute("aria-hidden","true"),i.id="react-modal-sheet-highlight",i.style.position="absolute",i.style.top="0px",i.style.left="0px",i.style.bottom="0px",i.style.right="0px",i.style.opacity="0",i.style.transition="opacity 200ms linear",i.style.backgroundColor="rgba(150, 150, 150, 0.1)",n.appendChild(i),requestAnimationFrame((function(){return i.style.opacity="1"}))}}(n):n&&!t&&o&&d(n)}),[t,o]),e.useEffect((function(){return function(){n&&t&&d(n)}}),[t])}(D,N),function(e){void 0===e&&(e={});var t=e.isDisabled;o.useLayoutEffect((function(){if(!t)return 1==++E&&(g=o.isIOS()?function(){var e,t=0,n=window.pageXOffset,r=window.pageYOffset,i=o.chain(x(document.documentElement,"paddingRight",window.innerWidth-document.documentElement.clientWidth+"px"),x(document.documentElement,"overflow","hidden"),x(document.body,"marginTop","-"+r+"px"));window.scrollTo(0,0);var a=o.chain(C(document,"touchstart",(function(n){(e=o.getScrollParent(n.target))===document.documentElement&&e===document.body||(t=n.changedTouches[0].pageY)}),{passive:!1,capture:!0}),C(document,"touchmove",(function(n){if(e!==document.documentElement&&e!==document.body){var o=n.changedTouches[0].pageY,r=e.scrollTop,i=e.scrollHeight-e.clientHeight;0!==i&&((r<=0&&o>t||r>=i&&o<t)&&n.preventDefault(),t=o)}else n.preventDefault()}),{passive:!1,capture:!0}),C(document,"touchend",(function(e){var t=e.target;R(t)&&t!==document.activeElement&&(e.preventDefault(),t.style.transform="translateY(-2000px)",t.focus(),requestAnimationFrame((function(){t.style.transform=""})))}),{passive:!1,capture:!0}),C(document,"focus",(function(e){var t=e.target;R(t)&&(t.style.transform="translateY(-2000px)",requestAnimationFrame((function(){t.style.transform="",b&&(b.height<window.innerHeight?requestAnimationFrame((function(){O(t)})):b.addEventListener("resize",(function(){return O(t)}),{once:!0}))})))}),!0),C(window,"scroll",(function(){window.scrollTo(0,0)})));return function(){i(),a(),window.scrollTo(n,r)}}():o.chain(x(document.documentElement,"paddingRight",window.innerWidth-document.documentElement.clientWidth+"px"),x(document.documentElement,"overflow","hidden"))),function(){0==--E&&g()}}),[t])}({isDisabled:!D});var re=e.useMemo((function(){return V?void 0:{drag:"y",dragElastic:0,dragConstraints:{top:0,bottom:0},dragMomentum:!1,dragPropagation:!1,onDrag:ne,onDragEnd:oe}}),[V]),ie=e.createElement(v.Provider,{value:{y:ee,sheetRef:J,isOpen:D,initialSnap:z,snapPoints:L,detent:j,indicatorRotation:K,callbacks:te,dragProps:re,windowHeight:Q,animationOptions:$,reduceMotion:Z}},e.createElement("div",Object.assign({},G,{ref:s,style:i({},S.wrapper,A)}),e.createElement(n.AnimatePresence,null,D?e.Children.map(H,(function(t,n){return e.cloneElement(t,{key:"sheet-child-"+n})})):null)));return c?ie:t.createPortal(ie,null!=q?q:document.body)})),T=e.forwardRef((function(t,o){var c=t.children,l=t.style,u=void 0===l?{}:l,d=t.className,f=void 0===d?"":d,p=a(t,["children","style","className"]),h=y(),g=h.y,v=h.snapPoints,b=h.initialSnap,w=void 0===b?0:b,E=h.sheetRef,x=h.windowHeight,C=h.detent,O=h.animationOptions,R=h.reduceMotion,P=function(t,n){var o=m(t),r=e.useRef(!1),i=e.useCallback((function(){r.current?(null==n.current.onCloseEnd||n.current.onCloseEnd(),r.current=!1):(null==n.current.onOpenEnd||n.current.onOpenEnd(),r.current=!0)}),[t,o]);return e.useEffect((function(){!o&&t?null==n.current.onOpenStart||n.current.onOpenStart():!t&&o&&(null==n.current.onCloseStart||n.current.onCloseStart())}),[t,o]),{handleAnimationComplete:i}}(h.isOpen,h.callbacks).handleAnimationComplete,T=v?v[0]-v[w]:0,M=v?v[0]:null,k=null!==M?"min("+M+"px, "+s+")":s;return e.createElement(n.motion.div,Object.assign({},p,{ref:r.mergeRefs([E,o]),className:"react-modal-sheet-container "+f,style:i({},S.container,u,"full-height"===C&&{height:k},"content-height"===C&&{maxHeight:k},{y:g}),initial:!R&&{y:x},animate:{y:T,transition:O},exit:{y:x,transition:O},onAnimationComplete:P}),c)})),M=e.forwardRef((function(t,o){var r=t.children,s=t.style,c=t.disableDrag,l=t.className,u=void 0===l?"":l,d=a(t,["children","style","disableDrag","className"]),f=y(),p=c?void 0:f.dragProps;return e.createElement(n.motion.div,Object.assign({},d,{ref:o,className:"react-modal-sheet-content "+u,style:i({},S.content,s)},p),r)})),k=e.forwardRef((function(t,o){var r=t.children,s=t.style,c=t.disableDrag,l=a(t,["children","style","disableDrag"]),u=y(),d=u.indicatorRotation,f=c?void 0:u.dragProps,p=n.useTransform(d,(function(e){return"translateX(2px) rotate("+e+"deg)"})),m=n.useTransform(d,(function(e){return"translateX(-2px) rotate("+-1*e+"deg)"}));return e.createElement(n.motion.div,Object.assign({},l,{ref:o,style:i({},S.headerWrapper,s)},f),r||e.createElement("div",{className:"react-modal-sheet-header",style:S.header},e.createElement(n.motion.span,{className:"react-modal-sheet-drag-indicator",style:i({},S.indicator,{transform:p})}),e.createElement(n.motion.span,{className:"react-modal-sheet-drag-indicator",style:i({},S.indicator,{transform:m})})))})),H=function(e){return!!e.onClick||!!e.onTap},D=e.forwardRef((function(t,o){var r=t.style,s=void 0===r?{}:r,c=t.className,l=void 0===c?"":c,u=a(t,["style","className"]),d=H(u)?n.motion.button:n.motion.div,f=H(u)?"auto":"none";return e.createElement(d,Object.assign({},u,{ref:o,className:"react-modal-sheet-backdrop "+l,style:i({},S.backdrop,s,{pointerEvents:f}),initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}}))})),L=P;L.Container=T,L.Header=k,L.Content=M,L.Backdrop=D,exports.default=L;
//# sourceMappingURL=react-modal-sheet.cjs.production.min.js.map
